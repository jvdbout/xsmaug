#!/bin/bash

 ############################################################################
 #                                                                          #
 #   X      X  ******* **    **  ******  **    **  ******                   #
 #    X    X  ******** ***  *** ******** **    ** ********       \\._.//    #
 #     X  X   **       ******** **    ** **    ** **             (0...0)    #
 #      XX    *******  ******** ******** **    ** **  ****        ).:.(     #
 #      XX     ******* ** ** ** ******** **    ** **  ****        {o o}     #
 #     X  X         ** **    ** **    ** **    ** **    **       / ' ' \    #
 #    X    X  ******** **    ** **    ** ******** ********    -^^.VxvxV.^^- #
 #   X      X *******  **    ** **    **  ******   ******                   #
 #                                                                          #
 # ------------------------------------------------------------------------ #
 # Ne[X]t Generation [S]imulated [M]edieval [A]dventure Multi[U]ser [G]ame  #
 # ------------------------------------------------------------------------ #
 # XSMAUG 2.4 (C) 2014  by Antonio Cao @burzumishi                          #
 # ------------------------------------------------------------------------ #
 #                                  @PACKAGE@                                  #
 ############################################################################

source @sysconfdir@/@PACKAGE@/@PACKAGE@.conf

function load_xsmaug {
	$bin/$xsmaug $port 2>> $log &
}

if [ ! -f "$bin/$xsmaug" ]; then
	echo
	echo "ERROR! No XSMAUG executable found!";
	echo "Try building the source first with 'make'.";
	echo
	exit 1;
fi;

load_xsmaug;

while true; do
	pidof $xsmaug >/dev/null
	if [ $? -eq 1 ]; then
		echo -n $(date)": ERROR! $xsmaug has failed ... reseting ...";
		load_xsmaug
		echo " done."
	fi;
	sleep 10;
done;
	
kill -9 `pidof $xsmaug`;

